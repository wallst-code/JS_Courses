<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/site.css" />
    <title>JavaScript Timed Actions</title>
  </head>
  <body>
    <main>
      <nav>
        <a href="index.html">Home | </a
        ><a href="createHTML.html">Create HTML | </a
        ><a href="events.html">Events | </a>
        <a href="timed-actions.html">Timed Actions | </a>
        <a href="forms.html">Forms</a>
      </nav>

      <h1>JavaScript Timed Actions</h1>

      <!-- <p id="first-paragraph">
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Voluptas
          beatae recusandae, totam similique in sint illo laudantium, repellendus
          officiis maxime eaque quasi voluptates perspiciatis. Numquam, totam
          eaque. Unde, autem nam! Lorem ipsum dolor sit, amet consectetur
          adipisicing elit. Voluptas beatae recusandae, totam similique in sint
          illo laudantium, repellendus officiis maxime eaque quasi voluptates
          perspiciatis. Numquam, totam eaque. Unde, autem nam!
        </p>
        <p id="second-paragraph" class="support-paragraph">
          Lorem ipsum dolor, sit amet consectetur adipisicing elit. Repellendus
          porro autem sunt magni voluptas exercitationem qui sed dolor corrupti
          ipsa dicta rerum, itaque enim provident ullam. Necessitatibus vitae ut
          quidem.lorem
        </p>
        <p id="third-paragraph" class="support-paragraph">
          Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quam veniam
          repellat natus assumenda eum itaque neque animi quae est, atque aperiam.
          Fugit reiciendis minima, cumque perspiciatis qui est consequatur
          officia?
        </p> -->
      <div id="list-section">
        <a id="add-to-list" href="#">Add New Element To List</a>
        <ul id="key-items">
          <li>Our First LI</li>
          <li>Our Second LI</li>
          <li>Our Third LI</li>
        </ul>
        <div>
            <h2 id="display-message">Send Demo Email</h2>
            <p id="status-message"></p>
            <a id="send-email" href="#">Send Email with Mistake</a>
            <br>
            <br>
            <a id="recall-email" href="#">Recall Email</a>
        
        
        </div>
      </div>
    </main>

    <script>
      "use strict";
// Set to strict
// Set up "global" variables (higher in scope for all functions) and capture/grab elements by id. 

      let i = 4;
      const list = document.getElementById("key-items");
      const addAction = document.getElementById("add-to-list");
      const displayMessage = document.getElementById('display-message');
      let timeoutId = 0;
      const sendEmailAnchor = document.getElementById('send-email'); // This grabs the element that we want by id.
      const cancelEmailAnchor = document.getElementById('recall-email');
      const statusMessage = document.getElementById('status-message');
      let countDown = 10;

      //Set up event listeners
    sendEmailAnchor.addEventListener('click', sendEmail); //sets up the listener for the element and sends the logic - calls the function
    cancelEmailAnchor.addEventListener('click', cancelEmail); // the reason you do not add () after cancelEmail is that you are not calling the function here, you are passing it as a parameter so it fires with a click event. 


     //Set up logic with functions
      function sendEmail (e) {
          e.preventDefault();
          timeoutId = setTimeout(countDownToSend); //runs the timer immediately or we can set (method, 1000) every thousand is 1 second.
      }

      function countDownToSend () {
          if (countDown > 0) {
              statusMessage.innerText = `Email will send in ${countDown} seconds...`;
              countDown--;
              timeoutId = setTimeout(countDownToSend, 1000);
          } else {
              actuallySendEmail();
              countDown = 10;
          }          
      }

      function cancelEmail (e) {
          e.preventDefault();
          clearTimeout(timeoutId);
          cancelSendEmail();
      }

      function actuallySendEmail () {
          displayMessage.innerText = 'The email has been sent!!!!!';
      }

      function cancelSendEmail () {
          displayMessage.innerText = 'The email has been recalled.';
          statusMessage.innerText = '';
      }

      


     
    //   addAction.addEventListener("click", addFromLink);

    //   function addFromLink(e) {
    //     e.preventDefault; // prevents the default element here the # tag in the URL.
    //     const li = document.createElement("li");
    //     li.innerText = `LI from anchor tag #${i}`;
    //     li.classList.add('new-item');
    //     i++;
    //     list.appendChild(li);
    //     setTimeout(removeNewItemClass, 2000, li);  //you do not need the () for the removenNewClass() - will  call this function after 2 seconds. 
    //     // addAction.removeEventListener("click", addFromLink); // This removes the action after it triggers once.
    //   }

    //   function removeNewItemClass(item) {
    //     //   const items = list.querySelectorAll('.new-item');
    //     //   const itemsArray = Array.from(items);
    //     //   itemsArray.forEach(el => el.classList.remove('new-item'));
    //     item.classList.remove('new-item'); //item is the passed in 'li' from the addFormLink. This makes it cascade more with separate timing of removing. 
    //   }


    </script>
  </body>
</html>
